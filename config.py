# config.py
# 설정값, 항공사 데이터, 상수 정의

from typing import List, Dict

# =========================
# 고정 전제: 면접 언어 = 한국어
# =========================

AIRLINES = [
    "대한항공", "아시아나", "제주", "진에어", "티웨이", "에어부산", "에어서울",
    "이스타", "에어로케이", "에어프레미아", "파라타항공"
]

AIRLINE_TYPE = {
    # FSC
    "대한항공": "FSC",
    "아시아나": "FSC",
    # LCC
    "제주": "LCC",
    "진에어": "LCC",
    "티웨이": "LCC",
    "에어부산": "LCC",
    "에어서울": "LCC",
    "이스타": "LCC",
    "에어로케이": "LCC",
    "에어프레미아": "LCC",
    "파라타항공": "LCC",
}

# =========================
# 항공사별 가치/인재상(내부 하드코딩, 외부 크롤링/LLM 없음)
# =========================

VALUES_DEFAULT = {
    "FSC": [
        "안전·규정 준수",
        "프리미엄 서비스 일관성",
        "국제적 커뮤니케이션",
        "정확한 절차 수행",
    ],
    "LCC": [
        "효율·우선순위 판단",
        "안전·규정 준수",
        "현장 대응력",
        "실행 중심 협업",
    ],
}

AIRLINE_VALUES = {
    "대한항공": ["안전·규정 준수", "프리미엄 서비스 일관성", "국제적 커뮤니케이션", "정확한 절차 수행"],
    "아시아나": ["안전·규정 준수", "고객 경험 품질", "정중한 커뮤니케이션", "서비스 일관성"],

    "제주": ["효율·우선순위 판단", "현장 대응력", "고객 응대 민첩성", "실행 중심 협업"],
    "진에어": ["효율·우선순위 판단", "안전·규정 준수", "표준화된 서비스 실행", "현장 대응력"],
    "티웨이": ["효율·우선순위 판단", "현장 대응력", "고객 응대 민첩성", "명확한 커뮤니케이션"],
    "에어부산": ["현장 대응력", "안전·규정 준수", "고객 커뮤니케이션", "실행 중심 협업"],
    "에어서울": ["효율·우선순위 판단", "현장 대응력", "고객 응대 민첩성", "서비스 실행력"],
    "이스타": ["효율·우선순위 판단", "현장 대응력", "문제 해결 실행", "고객 커뮤니케이션"],
    "에어로케이": ["효율·우선순위 판단", "현장 대응력", "안전·규정 준수", "실행 중심 협업"],
    "에어프레미아": ["안전·규정 준수", "서비스 실행력", "현장 대응력", "명확한 커뮤니케이션"],
    "파라타항공": ["효율·우선순위 판단", "현장 대응력", "안전·규정 준수", "고객 응대 민첩성"],
}

# =========================
# 항공사명 정규화 — 반드시 영구 고정
# =========================

_CANON_MAP = {
    "제주": "제주항공",
    "티웨이": "티웨이항공",
    "이스타": "이스타항공",
    "아시아나": "아시아나항공",
}
_DECANON_MAP = {v: k for k, v in _CANON_MAP.items()}


def _canonical_airline_name(airline: str) -> str:
    return _CANON_MAP.get(airline, airline)


def _raw_airline_key(airline: str) -> str:
    return _DECANON_MAP.get(airline, airline)


def airline_profile(airline: str) -> str:
    key = _raw_airline_key(airline)
    return AIRLINE_TYPE.get(key, "LCC")


def get_airline_values(airline: str) -> List[str]:
    key = _raw_airline_key(airline)
    atype = airline_profile(key)
    vals = AIRLINE_VALUES.get(key, [])
    if vals and len(vals) >= 3:
        return vals
    return VALUES_DEFAULT.get(atype, ["안전·규정 준수", "현장 대응력", "고객 커뮤니케이션"])


# =========================
# STEP 4: 템플릿 기반 질문 생성 + 안전장치
# =========================

MAX_TRIES = 30
SOFT_TIMEOUT_SEC = 2.8

# =========================
# 위험 신호 키워드 (면접 공격 포인트)
# =========================

RISK_TRIGGERS = [
    "노력", "최선", "열심", "성실", "원활", "기여", "도움", "향상", "개선", "만족", "긍정",
    "판단", "결정", "선택", "우선", "기준", "근거", "방향", "전략", "우선순위",
    "하게 되", "되었", "진행", "수행", "처리", "대응", "관리", "조치", "확인",
    "협업", "소통", "커뮤니케이션", "팀워크", "리드", "주도", "문제해결", "고객응대", "서비스",
]

# =========================
# LLM 설정
# =========================

ENABLE_PLAN_LIMITS = False
LLM_MODEL_NAME = "gpt-4o-mini"
LLM_TIMEOUT_SEC = 30
LLM_TTL_SEC = 18 * 60  # 15~20분 범위
LLM_API_URL = "https://api.openai.com/v1/chat/completions"

LLM_STATE_PENDING = "PENDING"
LLM_STATE_COMPLETED = "COMPLETED"
LLM_STATE_FAILED = "FAILED"
LLM_STATE_ABORTED = "ABORTED"

# =========================
# LLM JSON 필수 키 (검증용) - 새 공격 포인트 스키마
# =========================

LLM_REQUIRED_KEYS = [
    "claim",
    "over_idealized_points",
    "risk_points",
    "repeatability_questions",
]

# =========================
# 공격 포인트 → 질문 번역 템플릿 (핵심!)
# =========================

# over_idealized_points → Q2 (이상적 표현 공격)
# {point}: 이상적 표현, {premise}: 숨겨진 전제, {premise_broken}: 전제가 깨진 상황 (이미 "~상황이라면"으로 끝남)
# {judgment}: point에서 추출한 구체적 판단/행동 (예: "서로 의지하겠다", "극복하겠다")
# {who}: 상대방이 누구인지 (고객, 동료, 승객 등)
Q2_ATTACK_TEMPLATES = [
    # 날카로운 버전 (홀수) - 전제와 판단을 구체적으로 명시
    "'{point}'라고 하셨습니다. 이 말씀은 '{premise}'을 전제로 하는데, {premise_broken} 정말 그렇게 할 수 있습니까?",
    "'{point}'라고 말씀하셨는데, {premise_broken} 그래도 '{judgment}'고 말씀하실 수 있습니까?",
    "'{point}'라는 표현을 쓰셨습니다. 하지만 {who}이 비협조적인 상황에서도 가능합니까?",
    "'{point}'라고 하셨는데, 이건 '{premise}'을 전제로 한 말씀입니다. {premise_broken} 어떻게 하시겠습니까?",
    "'{point}'라는 말씀이 '{premise}'을 전제로 하고 있습니다. {premise_broken} 같은 판단을 유지할 수 있습니까?",
]

Q2_ATTACK_TEMPLATES_SOFT = [
    # 부드러운 버전 (짝수) - 전제와 판단을 구체적으로 명시
    "'{point}'라고 말씀해 주셨는데, {premise_broken} 어떻게 하셨을 것 같으세요?",
    "'{point}'라고 하셨는데, {who}이 냉담한 상황이라면 어떻게 되었을까요?",
    "'{point}'라고 하셨는데, '{premise}'이 항상 가능할까요? {premise_broken} 어떨 것 같으세요?",
    "'{point}'라는 표현이 인상적입니다. 그런데 {premise_broken} 같은 결과였을까요?",
    "'{point}'라고 하셨는데, {who}이 적대적인 상황이라면 어떻게 대처하실 것 같으세요?",
]

# 꿈/소망/목표 문장용 Q2 템플릿 (경험이 아님 - 적절한 질문 방식)
# {point}: 원문, {premise}: 숨겨진 전제, {premise_broken}: 전제가 깨진 상황
Q2_DREAM_TEMPLATES = [
    # 날카로운 버전 (홀수)
    "'{point}'라고 하셨는데, 그 꿈을 이루기 어려운 현실적 제약에 부딪히면 어떻게 하시겠습니까?",
    "'{point}'라는 말씀을 하셨습니다. 그런데 {premise_broken} 그 꿈을 포기하시겠습니까?",
    "'{point}'라고 하셨는데, 구체적으로 어떤 노력을 하고 계십니까?",
    "'{point}'라고 하셨습니다. 그 꿈이 현실과 다를 때 어떻게 대처하시겠습니까?",
    "'{point}'라는 꿈을 말씀하셨는데, 실제로 그 일을 해보신 경험이 있습니까?",
]

Q2_DREAM_TEMPLATES_SOFT = [
    # 부드러운 버전 (짝수)
    "'{point}'라는 꿈을 갖게 된 계기가 궁금합니다. 어떤 경험이 있으셨나요?",
    "'{point}'라고 하셨는데, 그 꿈을 위해 구체적으로 어떤 준비를 하고 계세요?",
    "'{point}'라는 말씀이 인상적인데요. {premise_broken} 어떻게 하실 것 같으세요?",
    "'{point}'라고 하셨는데, 그 꿈을 이루기 위해 가장 중요한 것은 무엇이라고 생각하세요?",
    "'{point}'라는 목표를 갖고 계시는군요. 그 목표에 가까워지고 있다고 느끼시나요?",
]

# 추상적/비유적 문장 감지 패턴 (이런 문장은 다른 질문 스타일 적용)
ABSTRACT_SENTENCE_PATTERNS = [
    "다큐멘터리", "영화", "드라마", "소설", "책", "이야기",
    "한 편의", "하나의", "마치", "처럼", "같은",
    "상징", "의미", "표현", "비유",
]

# 추상적 문장용 Q2 템플릿 (비유/표현 자체를 물어봄)
# {point}: 원문, {short_point}: 핵심 키워드만 추출한 짧은 버전
Q2_ABSTRACT_TEMPLATES = [
    # 날카로운 버전 (홀수) - 핵심만 짚어서 날카롭게
    "'{short_point}'라고 하셨는데, 왜 이런 비유를 선택하셨습니까?",
    "'{short_point}'라는 표현을 쓰셨는데, 구체적으로 무엇을 의미하는 겁니까?",
    "'{short_point}'라고 하셨습니다. 비유가 아닌 실제 행동으로 설명해 주시겠습니까?",
    "'{short_point}'라는 말씀이 추상적인데, 면접관이 이해할 수 있게 구체적으로 말씀해 주시겠습니까?",
    "'{short_point}'라고 표현하셨는데, 실제로 어떤 경험이나 행동을 말씀하시는 겁니까?",
]

Q2_ABSTRACT_TEMPLATES_SOFT = [
    # 부드러운 버전 (짝수) - 핵심만 짚어서 부드럽게
    "'{short_point}'라는 표현이 인상적인데요, 조금 더 구체적으로 설명해 주실 수 있으세요?",
    "'{short_point}'라고 하셨는데, 어떤 의미인지 궁금합니다.",
    "'{short_point}'라는 표현을 쓰셨는데, 실제로 어떤 경험을 말씀하시는 건가요?",
    "'{short_point}'라고 하셨는데, 왜 이런 표현을 선택하셨는지 알려주실 수 있으세요?",
    "'{short_point}'에 대해 조금 더 구체적으로 말씀해 주시겠어요?",
]

# risk_points → Q2 변형 (취약점 공격)
Q2_RISK_TEMPLATES = [
    # 날카로운 버전 (홀수)
    "'{risk}'의 가능성에 대해서는 어떻게 생각하시나요? 그런 상황이 와도 같은 판단을 하실 수 있습니까?",
    "'{risk}'라는 상황이 올 수 있습니다. 그때 본인의 선택은 달라지지 않을까요?",
    "'{risk}'의 상황에서 본인의 가치관이 무너질 수도 있지 않을까요?",
    "'{risk}'를 감수해야 할 때, 본인의 기준은 무엇입니까?",
    "'{risk}'의 위험을 알면서도 같은 선택을 하시겠습니까?",
]

Q2_RISK_TEMPLATES_SOFT = [
    # 부드러운 버전 (짝수)
    "'{risk}'라는 상황이 올 수도 있는데, 그런 경우에는 어떻게 대처하실 것 같으세요?",
    "혹시 '{risk}'에 대해 생각해 보신 적 있으세요?",
    "'{risk}'의 상황에서는 어떤 점을 가장 중요하게 생각하실 것 같으세요?",
    "'{risk}'라는 어려움이 있을 수 있는데, 어떻게 준비하고 계세요?",
    "'{risk}'의 가능성도 있잖아요. 그런 부분은 어떻게 생각하세요?",
]

# rejected_alternatives → Q2 변형 (대안 공격)
Q2_ALTERNATIVE_TEMPLATES = [
    # 날카로운 버전 (홀수)
    "'{alt}'라는 방법도 있었을 텐데, 왜 그것은 선택하지 않으셨습니까?",
    "'{alt}'를 선택했다면 결과가 더 좋았을 수도 있지 않을까요?",
    "'{alt}'가 오히려 나은 선택이었을 수도 있는데, 그 가능성은 고려하지 않으셨습니까?",
    "'{alt}'를 배제한 이유가 무엇입니까? 정당한 근거가 있습니까?",
    "'{alt}'를 선택하지 않은 것이 후회되지 않습니까?",
]

Q2_ALTERNATIVE_TEMPLATES_SOFT = [
    # 부드러운 버전 (짝수)
    "'{alt}'라는 방법도 고려해 보셨나요? 어떤 점에서 다른 선택을 하셨는지 궁금합니다.",
    "'{alt}'도 하나의 방법이었을 것 같은데, 그 대신 다른 선택을 하신 이유가 있으셨나요?",
    "'{alt}'와 비교했을 때, 본인의 선택이 더 나았던 점은 무엇인가요?",
    "'{alt}'를 선택하지 않은 특별한 이유가 있으셨나요?",
    "'{alt}'도 생각해 보셨을 것 같은데, 최종적으로 어떤 기준으로 결정하셨나요?",
]

# =========================
# Q3 꼬리질문 템플릿 (4가지 유형 - Q2 맥락 상속)
# =========================
# 핵심: 답변 강요 X, 사고 확장 O, Q2의 연장선
# {premise_broken}: Q2에서 사용한 전제가 깨진 상황

# ① 조건 변화형: "만약 ○○ 조건이 달라진다면?"
Q3_CONDITION_CHANGE = [
    "만약 {premise_broken} 그때도 같은 판단을 하실 수 있을까요?",
    "{premise_broken} 그 상황에서도 방금 말씀하신 방식이 적용될 수 있을까요?",
    "조건이 달라져서 {premise_broken} 그래도 같은 선택을 하시겠어요?",
]

# ② 우선순위 충돌형: "둘 다 중요할 때 무엇을 먼저 선택하는가"
Q3_PRIORITY_CONFLICT = [
    "만약 팀 분위기와 규정 준수가 동시에 충돌한다면, 어떤 기준을 먼저 적용하시겠어요?",
    "고객 만족과 안전 절차가 충돌하는 상황이라면, 무엇을 우선시하시겠어요?",
    "효율성과 정확성 중 하나만 선택해야 한다면, 어떤 기준으로 판단하시겠어요?",
]

# ③ 한계 인식형: "그 선택의 약점은 무엇인가"
Q3_LIMIT_RECOGNITION = [
    "방금 말씀하신 방식이 오히려 문제가 될 수 있는 상황은 언제라고 생각하세요?",
    "그 판단이 잘못될 수도 있는 경우가 있다면, 어떤 상황일까요?",
    "본인의 그 방식에 약점이 있다면, 무엇이라고 생각하세요?",
]

# ④ 재현성 검증형: "다음에도 가능한가"
Q3_REPEATABILITY = [
    "만약 팀원이 바뀌거나 본인이 신입 입장이었더라도 같은 판단을 하실 수 있을까요?",
    "비슷한 상황이 다시 온다면, 그때도 같은 방식으로 대처하실 수 있을까요?",
    "다른 환경에서도 같은 결과를 낼 수 있을까요?",
]

# =========================
# Q3 꿈/목표 문장 전용 템플릿 (Q2가 꿈/목표일 때 사용)
# =========================
Q3_DREAM_CONDITION = [
    "만약 {premise_broken} 그래도 그 꿈을 향해 나아가실 수 있을까요?",
    "{premise_broken} 그 상황에서도 같은 목표를 유지하실 수 있을까요?",
    "현실적인 어려움이 생긴다면, 그 꿈에 대한 생각이 바뀔 수도 있을까요?",
]

Q3_DREAM_PRIORITY = [
    "그 꿈을 이루기 위해 포기해야 할 것이 있다면, 무엇을 선택하시겠어요?",
    "안정적인 삶과 그 꿈이 충돌한다면, 어떤 기준으로 판단하시겠어요?",
    "다른 기회가 생긴다면, 그래도 이 길을 선택하시겠어요?",
]

Q3_DREAM_LIMIT = [
    "그 꿈을 향해 가는 과정에서 본인의 약점이 될 수 있는 부분은 무엇이라고 생각하세요?",
    "그 목표가 오히려 부담이 될 수 있는 상황은 언제라고 생각하세요?",
    "그 꿈을 이루지 못했을 때, 어떻게 받아들이실 것 같으세요?",
]

Q3_DREAM_REPEAT = [
    "그 꿈을 갖게 된 계기가 지금도 유효한가요?",
    "시간이 지나도 그 목표가 변하지 않을 거라고 확신하시나요?",
    "주변 환경이 바뀌어도 그 꿈을 계속 추구하실 수 있을까요?",
]

# =========================
# Q1 공통 질문 풀 (version에 따라 결정론적 선택)
# =========================

Q1_POOL = [
    "승무원으로서 안전과 서비스가 동시에 요구되는 상황에서 무엇을 먼저 선택하고 어떤 행동으로 마무리하겠습니까?",
    "서비스와 안전 중에 무엇이 더 중요하다고 생각하며, 그 이유는 무엇입니까?",
    "승무원이 되기 위해서 길러온 역량은 무엇이며, 어떻게 활용하겠습니까?",
    "어떤 승무원이 가장 이상적이라고 생각하며, 본인은 어떤 승무원이 되겠습니까?",
    "승무원으로서 가장 중요하게 생각하는 자질은 무엇이며, 본인은 그 자질을 어떻게 갖추었습니까?",
    "승무원의 역할 중 가장 핵심적인 것은 무엇이라고 생각하며, 어떻게 수행하겠습니까?",
    "승무원이 된다면 가장 어려울 것으로 예상되는 부분은 무엇이며, 어떻게 극복하겠습니까?",
    "동료 승무원들과 함께 일할 때 본인이 중요하게 생각하는 것은 무엇입니까?",
    "고객에게 신뢰를 주는 승무원이 되기 위해 어떤 노력을 하겠습니까?",
    "비행 중 예상치 못한 상황이 발생했을 때, 어떤 순서로 판단하고 행동하겠습니까?",
]

# 기존 호환성을 위한 Q1_FIXED (첫 번째 질문)
Q1_FIXED = Q1_POOL[0]

# =========================
# Q5 돌발/확장 풀 (경험형 금지: 판단/가정/상황만)
# =========================

Q5_POOL = [
    "압박이 큰 상황에서 설명을 짧게 정리해야 할 때, 어떤 순서로 말하고 어떤 행동부터 실행하겠습니까?",
    "규정과 승객 요구가 동시에 걸린 상황에서 선택을 빠르게 정리해야 할 때, 무엇을 먼저 선택하겠습니까?",
    "본인 선택이 결과적으로 좋지 않았던 상황이 발생하면, 어떤 방식으로 인정하고 어떤 조치를 하겠습니까?",
    "팀 내 의견이 갈린 상황에서 결론을 내야 할 때, 어떤 방식으로 조율하고 어떤 행동으로 마무리하겠습니까?",
    "승무원 역할에서 부족하다고 느끼는 부분이 나타난 상황을 가정했을 때, 어떤 학습 행동으로 보완하겠습니까?",
    "기내에서 승객 간 갈등이 발생한 상황을 가정할 때, 어떤 순서로 개입하고 어떤 안내를 하겠습니까?",
    "비행 중 예상치 못한 기상 변화로 일정이 지연된 상황에서, 승객에게 어떤 정보를 먼저 안내하겠습니까?",
    "동료 승무원이 업무 중 실수를 한 상황을 가정할 때, 어떤 방식으로 지적하고 어떤 행동으로 보완하겠습니까?",
    "승객의 요청이 규정상 수용 불가한 상황에서, 어떤 문장으로 거절하고 어떤 대안을 제시하겠습니까?",
    "기내에서 의료 응급 상황이 발생했을 때, 무엇을 먼저 확인하고 어떤 순서로 조치하겠습니까?",
]

# =========================
# Q5 경험형 금지어 (폴백 트리거)
# =========================

Q5_FORBIDDEN_WORDS = ["경험", "사례", "해본", "했던", "겪은", "있었던"]

# =========================
# 금칙어/지칭어
# =========================

FORBIDDEN_DEICTIC = ["그 ", "그것", "그런", "이런", "해당", "위의"]
FORBIDDEN_WORDS_IN_Q = ["기준", "판단 기준", "원칙"]

# =========================
# 한국어 불용어
# =========================

STOPWORDS_KOR = set([
    "그리고", "그래서", "하지만", "또한", "또는", "때문", "때문에", "저는", "제가", "저를", "저의",
    "저희", "우리", "이번", "이후", "당시", "처음", "현재", "정말", "매우", "가장", "조금", "좀",
    "통해", "하여", "해서", "하며", "했고", "합니다", "했습니다", "하였다", "있습니다", "됩니다",
    "것", "수", "등", "및", "또", "더", "같은", "같이", "같습니다", "경험", "사람", "상황", "문제",
    "노력", "최선", "열심", "성실", "원활", "기여", "도움", "향상", "개선", "만족", "긍정",
])

# =========================
# 질문 템플릿
# =========================

FSC_VALUE_DATA = {
    "keywords": AIRLINE_VALUES.get("대한항공", VALUES_DEFAULT["FSC"]),
    "desc": "규정과 원칙을 기반으로 안전을 최우선에 두고, 책임 있게 판단하며 프리미엄 서비스의 일관성을 유지하는 태도를 중시합니다.",
}
LCC_VALUE_DATA = {
    "keywords": VALUES_DEFAULT["LCC"],
    "desc": "현장에서 빠르게 우선순위를 세우고 실행하며, 안전을 전제로 팀 흐름을 유지하는 실용적 판단과 대응을 중시합니다.",
}

# NOTE: 아래 템플릿은 f-string이 아니라 .format(...) 용 플레이스홀더 템플릿입니다.
VALUE_Q_TEMPLATES_FSC = [
    "{airline} 인재상에서 '{kw1}'과 '{kw2}'가 동시에 요구됩니다. 고객 요청과 규정 준수가 충돌하는 상황에서 무엇을 먼저 선택하고, 어떤 행동으로 마무리하겠습니까?",
    "{airline} 지원자에게 {kw1}과 {kw2}가 함께 요구됩니다. 탑승객 불만이 발생한 상황에서 우선순위를 어떻게 정하고, 어떤 안내를 실행하겠습니까?",
    "{airline} 인재상은 {desc}로 요약할 수 있습니다. 일정 지연이 발생한 상황에서 안전과 서비스 사이의 선택을 어떻게 정리하고 어떤 조치를 하겠습니까?",
]
VALUE_Q_TEMPLATES_LCC = [
    "{airline} 지원자에게 '{kw1}'과 '{kw2}'가 동시에 요구됩니다. 여러 업무가 몰린 상황에서 무엇을 먼저 선택하고 어떤 행동으로 처리하겠습니까?",
    "{airline}은 {kw1}을 전제로 {kw2}를 요구합니다. 고객 요청이 연속으로 들어오는 상황에서 우선순위를 어떻게 정하고 어떤 안내를 실행하겠습니까?",
    "{airline} 인재상은 {desc}로 요약할 수 있습니다. 변수로 일정이 흔들린 상황에서 선택을 어떻게 정리하고 어떤 조치를 하겠습니까?",
]

COMMON_TEMPLATES_FSC_V2 = [
    "최근 3개월 내에 일정이 흔들린 상황에서 무엇을 먼저 선택했고, 어떤 행동으로 정리했습니까?",
    "규정 준수와 고객 만족이 동시에 걸린 상황에서 무엇을 먼저 선택했고, 어떤 안내를 했습니까?",
    "서비스 품질과 안전 확인이 동시에 요구된 상황에서 무엇을 먼저 확인했고, 어떤 조치를 했습니까?",
    "팀 내 역할이 겹친 상황에서 본인이 맡을 일을 어떻게 정리했고, 어떤 방식으로 공유했습니까?",
]
COMMON_TEMPLATES_LCC_V2 = [
    "현장에서 변수가 생긴 상황에서 무엇을 먼저 확인했고, 어떤 행동으로 처리했습니까?",
    "동시에 여러 업무가 들어온 상황에서 처리 순서를 어떻게 정했고, 첫 행동은 무엇이었습니까?",
    "팀 흐름이 흔들린 상황에서 본인이 가장 먼저 실행한 정리 행동은 무엇이었습니까?",
    "예상치 못한 요청이 들어온 상황에서 무엇을 먼저 선택했고, 어떤 조치를 했습니까?",
]

SURPRISE_TEMPLATES_FSC_V2 = [
    "압박이 큰 상황에서 설명을 짧게 정리해야 할 때, 어떤 순서로 말하고 어떤 행동부터 실행하겠습니까?",
    "규정과 승객 요구가 동시에 걸린 상황에서 선택을 빠르게 정리해야 할 때, 무엇을 먼저 선택하겠습니까?",
    "본인 선택이 결과적으로 좋지 않았던 상황이 발생하면, 어떤 방식으로 인정하고 어떤 조치를 하겠습니까?",
    "팀 내 의견이 갈린 상황에서 결론을 내야 할 때, 어떤 방식으로 조율하고 어떤 행동으로 마무리하겠습니까?",
    "승무원 역할에서 부족하다고 느끼는 부분이 나타난 상황을 가정했을 때, 어떤 학습 행동으로 보완하겠습니까?",
]
SURPRISE_TEMPLATES_LCC_V2 = [
    "압박이 큰 상황에서 설명을 짧게 정리해야 할 때, 어떤 순서로 말하고 어떤 행동부터 실행하겠습니까?",
    "현장에서 승객 요구와 규정 준수가 동시에 걸린 상황에서 무엇을 먼저 선택하고 어떤 안내를 하겠습니까?",
    "본인 선택이 결과적으로 좋지 않았던 상황이 발생하면, 어떤 방식으로 인정하고 어떤 조치를 하겠습니까?",
    "팀 내 의견이 갈린 상황에서 결론을 내야 할 때, 어떤 방식으로 조율하고 어떤 행동으로 마무리하겠습니까?",
    "승무원 역할에서 부족하다고 느끼는 부분이 나타난 상황을 가정했을 때, 어떤 학습 행동으로 보완하겠습니까?",
]

# 검증형 Q2 템플릿 (JEONGGEUM 수준: 신념 정면 공격, 부작용 검증, 책임 귀속)
Q2_TPL_BY_TYPE: Dict[str, Dict[int, List[str]]] = {
    "경험 요구형": {
        1: [
            '{experience}에서 {core_value}의 힘을 강조하셨습니다. 그렇다면 반대로, {core_value}을 지키기 위해 개인의 문제를 눈감아준 경험은 없습니까? 만약 있었다면, 그 선택이 정말 옳았다고 지금도 말할 수 있나요?',
            '{experience}에서 {action}을 통해 문제를 해결했다고 하셨습니다. 그런데 만약 그 선택 때문에 다른 문제가 생겼다면, 그 책임은 누구에게 있다고 생각하나요?',
        ],
        2: [
            '{action}을 선택하셨다고 했습니다. 그런데 만약 그 선택 때문에 팀의 성과가 떨어졌고, 누군가는 진지하게 임하지 않게 되었다면, 그 책임은 누구에게 있다고 생각하나요?',
            '{core_value}을 중요하게 여기신다고 했는데, 그렇다면 반대로, {core_value} 때문에 오히려 손해를 본 경험은 없습니까? 그때도 같은 선택을 하시겠습니까?',
        ],
        3: [
            '{experience}에서 {action}을 했다고 하셨습니다. 그런데 팀원 중 한 명이 그 방식에 반대했고, 결국 팀이 분열되었다면, 본인의 선택을 끝까지 밀고 나가시겠습니까, 아니면 철회하시겠습니까?',
            '{core_value}을 실천하기 위해 {action}을 택하셨는데, 그 방식이 오히려 팀에 부담이 되었다면, 그때도 본인의 선택이 옳았다고 말할 수 있습니까?',
        ],
        4: [
            '{experience}에서의 선택이 예상과 완전히 다른 결과를 가져왔다면, 본인은 그 실패를 어떻게 설명하시겠습니까? 운이 나빴다고 하시겠습니까, 판단이 틀렸다고 하시겠습니까?',
            '{action}의 부작용이 현실화되어 누군가 피해를 입었다면, 본인은 어떤 책임을 지시겠습니까?',
        ],
        5: [
            '{experience}와 같은 상황이 다시 온다면, 본인은 정말 다르게 행동할 수 있습니까? 아니면 결국 같은 선택을 반복하게 될 것 같습니까?',
            '{core_value}을 지키기 위해 규정을 어긴 적은 없습니까? 만약 그런 상황이 온다면 어떻게 하시겠습니까?',
        ],
    },
    "가치·태도 정합성형": {
        1: [
            '{core_value}을 중요하게 생각하신다고 했습니다. 그렇다면 반대로, {core_value}을 지키기 위해 고객에게 거짓말을 한 적은 없습니까? 만약 그런 상황이 온다면 어떻게 하시겠습니까?',
            '{experience}에서 {action}을 했다고 하셨는데, 만약 그 상황에서 고객이 강하게 항의했다면, 본인의 선택을 철회하셨겠습니까, 끝까지 밀고 나가셨겠습니까?',
        ],
        2: [
            '{core_value}을 강조하셨는데, 그렇다면 반대로, {core_value} 때문에 동료에게 피해를 준 적은 없습니까? 그때 본인은 어떻게 책임을 지셨습니까?',
            '{experience}에서의 선택이 다른 팀원에게 부담이 되었다면, 본인은 그것을 알면서도 그 선택을 밀고 나가셨겠습니까?',
        ],
        3: [
            '{action}으로 상황을 해결했다고 하셨는데, 만약 팀 전체가 본인의 방식에 반대했다면, 본인 혼자만 옳고 나머지가 다 틀린 것입니까?',
            '{core_value}을 지키면서 동료와 충돌한 적이 있습니까? 그때 본인이 양보한 것은 무엇이고, 끝까지 지킨 것은 무엇입니까?',
        ],
        4: [
            '{experience}에서의 선택에 부작용이 생겼다면, 본인은 그 책임을 인정하시겠습니까, 아니면 상황 탓을 하시겠습니까?',
            '{core_value}을 우선한 결과가 오히려 더 큰 문제를 만들었다면, 그때도 본인의 가치관이 옳았다고 말할 수 있습니까?',
        ],
        5: [
            '실제 승무원 업무에서 감정노동이 반복될 때, 지금 말씀하신 {core_value}이 직무의 일부였다는 사실을 실감하게 되는 순간이 올 것입니다. 그때 본인의 직업관은 흔들리지 않을 수 있습니까?',
            '매일 같은 상황에서 같은 미소를 지어야 할 때, 그것이 진심이 아니라 직무라는 것을 깨닫는 순간이 올 것입니다. 그때도 이 직업을 선택할 이유는 무엇입니까?',
        ],
    },
    "동기·정체성형": {
        1: [
            '승무원의 미소와 배려가 본인에게 꿈이 되었다고 하셨습니다. 그렇다면 반대로, 그 미소가 직무의 일부였다는 사실을 처음으로 실감하게 되는 순간이 왔을 때, 본인의 직업관은 흔들리지 않을 수 있습니까? 만약 흔들린다면, 그때도 이 직업을 선택할 이유는 무엇입니까?',
            '{experience}이 승무원을 꿈꾸게 된 계기라고 하셨는데, 그 경험이 실제 업무와 완전히 다르다는 것을 알게 되었을 때, 본인은 실망하지 않을 자신이 있습니까?',
        ],
        2: [
            '{core_value}을 중요하게 생각하신다고 했는데, 그렇다면 반대로, 그 가치 때문에 본인이 손해를 보거나 희생해야 하는 상황이 온다면, 그때도 같은 선택을 하시겠습니까?',
            '승무원이라는 직업을 선택한 이유가 감성적으로 잘 표현되어 있습니다. 그런데 현실에서 고객 불만, 감정노동, 불규칙한 생활이 반복될 때도 같은 열정을 유지할 수 있습니까? 솔직하게 말씀해 주세요.',
        ],
        3: [
            '{experience}에서 {action}을 했다고 하셨는데, 그 역할이 본인이 원한 것이었습니까, 아니면 상황에 떠밀린 것이었습니까? 만약 후자라면, 승무원 업무에서도 같은 일이 반복될 수 있습니다.',
            '본인이 생각하는 승무원의 역할과 실제 업무가 다르다면, 본인은 어떻게 적응하시겠습니까? 아니면 적응하지 못하고 그만두시겠습니까?',
        ],
        4: [
            '지금 말씀하신 동기와 열정이 1년, 3년 후에도 유지될 것이라고 확신할 수 있습니까? 만약 그 열정이 사라진다면, 그때도 이 직업을 계속할 이유는 무엇입니까?',
            '{core_value}을 지키기 위해 현실과 타협하지 않겠다고 하셨는데, 그렇다면 반대로, 현실 때문에 그 가치를 포기해야 하는 순간이 온다면 어떻게 하시겠습니까?',
        ],
        5: [
            '{experience} 이후 그 동기를 유지하기 위해 구체적으로 어떤 행동을 반복하고 계십니까? 만약 특별히 없다면, 그 동기가 진짜인지 의심이 됩니다.',
            '지금의 열정과 동기가 현실의 벽 앞에서 무너질 수 있다는 것을 알고 계십니까? 그때 본인은 어떻게 버티시겠습니까?',
        ],
    },
}

# Q3 꼬리질문 템플릿 (JEONGGEUM 수준: Q2에서 파고들어 더 깊이 검증)
# 주의: {experience}는 짧은 명사구 (예: "중국 유학", "축구 동아리")
Q3_TPL_BY_TYPE: Dict[str, Dict[int, List[str]]] = {
    "경험 요구형": {
        1: [
            "방금 그 선택이 옳았다고 하셨는데, 그렇다면 왜 처음부터 그렇게 하지 않으셨습니까? 뒤늦게 깨달은 것이라면, 그 판단력을 신뢰할 수 있습니까?",
            "{action}을 선택한 것이 최선이었다고 하셨는데, 다른 선택지는 진지하게 검토하셨습니까? 아니면 그냥 그것밖에 없었던 것입니까?",
        ],
        2: [
            "책임이 본인에게 있다고 하셨는데, 그렇다면 구체적으로 어떤 책임을 지셨습니까? 말로만 책임을 인정하신 것은 아닙니까?",
            "같은 선택을 하시겠다고 하셨는데, 그렇다면 본인은 실패에서 아무것도 배우지 못한 것입니까?",
        ],
        3: [
            "끝까지 밀고 나가시겠다고 하셨는데, 그것이 고집인지 소신인지 어떻게 구분하십니까? 팀원들은 본인을 어떻게 평가했습니까?",
            "본인의 선택이 옳았다고 하셨는데, 팀에 부담을 준 것도 사실 아닙니까? 그 부담에 대한 사과나 보상은 하셨습니까?",
        ],
        4: [
            "판단이 틀렸다고 인정하셨는데, 그렇다면 같은 상황이 또 온다면 어떤 판단을 하시겠습니까? 구체적으로 말씀해 주세요.",
            "책임을 지시겠다고 하셨는데, 실제로 어떤 방식으로 책임을 지셨습니까? 구체적인 행동이 있었습니까?",
        ],
        5: [
            "다르게 행동하시겠다고 하셨는데, 왜 그때는 그렇게 하지 못하셨습니까? 지금은 달라졌다는 근거가 있습니까?",
            "규정을 어긴 적이 없다고 하셨는데, 정말입니까? 사소한 것이라도 예외를 둔 적은 없습니까?",
        ],
    },
    "가치·태도 정합성형": {
        1: [
            "거짓말을 한 적이 없다고 하셨는데, 고객을 위해 사실을 조금 포장한 적도 없습니까? 그것도 거짓말 아닙니까?",
            "끝까지 밀고 나가셨다고 하셨는데, 그 결과 고객은 만족하셨습니까? 아니면 본인만 만족하신 것입니까?",
        ],
        2: [
            "책임을 지셨다고 하셨는데, 동료는 그것을 책임으로 받아들였습니까? 본인 생각과 동료 생각이 다를 수 있습니다.",
            "알면서도 밀고 나가셨다고 하셨는데, 그것이 배려입니까, 독선입니까? 동료는 어떻게 느꼈을까요?",
        ],
        3: [
            "본인 혼자만 옳은 것이 아니라고 하셨는데, 그렇다면 왜 팀 전체가 반대했을 때 본인의 방식을 고집하셨습니까?",
            "양보한 것과 지킨 것을 말씀하셨는데, 그 기준은 무엇이었습니까? 본인 편의대로 정한 것은 아닙니까?",
        ],
        4: [
            "책임을 인정하시겠다고 하셨는데, 인정하는 것과 실제로 책임지는 것은 다릅니다. 어떻게 책임을 지시겠습니까?",
            "본인의 가치관이 옳았다고 하셨는데, 결과가 나빴는데도 가치관이 옳을 수 있습니까? 그것이 자기합리화는 아닙니까?",
        ],
        5: [
            "흔들리지 않을 수 있다고 하셨는데, 그것을 어떻게 증명하시겠습니까? 아직 경험해보지 않은 것 아닙니까?",
            "이 직업을 선택할 이유를 말씀하셨는데, 그 이유가 현실 앞에서 버틸 수 있을 만큼 강한가요? 솔직하게 답해 주세요.",
        ],
    },
    "동기·정체성형": {
        1: [
            "흔들리지 않을 수 있다고 하셨는데, 아직 그 순간을 경험해보지 않으셨잖아요. 그것이 자신감입니까, 무지입니까?",
            "실망하지 않을 자신이 있다고 하셨는데, 실망했을 때 어떻게 하시겠습니까? 그만두시겠습니까, 버티시겠습니까?",
        ],
        2: [
            "같은 선택을 하시겠다고 하셨는데, 손해를 보면서도 정말 그 선택을 유지할 수 있습니까? 말은 쉽습니다.",
            "솔직하게 말씀해 달라고 했는데, 방금 하신 답변이 정말 솔직한 것입니까? 면접용 답변은 아닙니까?",
        ],
        3: [
            "상황에 떠밀린 것이라고 하셨는데, 그렇다면 승무원 업무에서도 떠밀려서 하시겠다는 것입니까? 그것이 동기입니까?",
            "적응하시겠다고 하셨는데, 구체적으로 어떻게 적응하시겠습니까? 막연한 각오가 아니라 실제 계획을 말씀해 주세요.",
        ],
        4: [
            "열정이 사라져도 계속할 이유를 말씀하셨는데, 그것이 진짜 이유입니까? 아니면 지금 열정이 있으니까 그렇게 말씀하시는 것입니까?",
            "현실 때문에 가치를 포기해야 한다면 어떻게 하시겠느냐고 물었는데, 답을 회피하신 것 같습니다. 다시 한번 답해 주세요.",
        ],
        5: [
            "구체적인 행동을 말씀하셨는데, 그것이 정말 동기를 유지하는 데 효과가 있었습니까? 아니면 그냥 하고 있는 것입니까?",
            "버티시겠다고 하셨는데, 어떻게 버티시겠습니까? 구체적인 방법이 없으면 버틸 수 없습니다.",
        ],
    },
}

# 부드러운 Q2 템플릿 (버전2, 4, 6... 짝수 버전용)
Q2_TPL_SOFT_BY_TYPE: Dict[str, Dict[int, List[str]]] = {
    "경험 요구형": {
        1: [
            '{experience}에서 {core_value}의 중요성을 강조해 주셨는데요. 혹시 그 과정에서 예상과 다른 결과가 나온 적은 없었나요? 그때 어떻게 대처하셨는지 궁금합니다.',
            '{experience}에서 {action}을 하셨다고 하셨는데, 다른 방법도 고려해 보셨나요? 그 선택을 하게 된 계기가 궁금합니다.',
        ],
        2: [
            '{action}을 선택하셨다고 하셨는데, 그 결정을 내리기까지 어떤 고민이 있으셨나요?',
            '{core_value}을 실천하시면서 어려웠던 점은 무엇이었나요? 그 어려움을 어떻게 극복하셨는지 말씀해 주세요.',
        ],
        3: [
            '{experience}에서 팀원들과 의견이 달랐던 적이 있으셨나요? 그때 어떻게 조율하셨는지 궁금합니다.',
            '{action}을 하시면서 팀에 부담이 되지 않을까 걱정하신 적은 없으셨나요?',
        ],
        4: [
            '{experience}에서의 경험이 예상대로 되지 않았다면 어떻게 하셨을 것 같으세요?',
            '{action}의 결과가 좋지 않았을 때를 대비해서 어떤 대안을 생각해 두셨나요?',
        ],
        5: [
            '비슷한 상황이 다시 온다면, 같은 방식으로 하실 것 같으세요? 아니면 다르게 해보고 싶은 부분이 있으신가요?',
            '이 경험을 통해 배운 점을 실제 승무원 업무에 어떻게 적용하실 수 있을까요?',
        ],
    },
    "가치·태도 정합성형": {
        1: [
            '{core_value}을 중요하게 생각하신다고 하셨는데, 만약 고객의 요청이 규정과 맞지 않을 때는 어떻게 대응하실 것 같으세요?',
            '{experience}에서의 경험을 말씀해 주셨는데, 고객이 강하게 항의하셨다면 어떻게 설명하셨을 것 같으세요?',
        ],
        2: [
            '{core_value}을 실천하시면서 동료에게 미안했던 적은 없으셨나요? 그때 어떻게 하셨는지 궁금합니다.',
            '본인의 선택이 다른 분들에게 영향을 줄 수 있다는 걸 알고 계셨나요? 어떻게 조율하셨나요?',
        ],
        3: [
            '팀 전체의 의견과 본인의 생각이 달랐던 적이 있으셨나요? 그때 어떻게 결론을 내셨는지 궁금합니다.',
            '{core_value}을 지키면서 동료와 조율이 필요했던 경험이 있으시면 말씀해 주세요.',
        ],
        4: [
            '예상치 못한 상황이 발생했을 때 어떻게 대처하셨나요?',
            '{core_value}을 지키려다 보니 오히려 어려움이 생긴 적은 없으셨나요?',
        ],
        5: [
            '승무원 업무에서 감정적으로 힘든 순간이 올 수 있는데, 그럴 때 어떻게 마음을 관리하실 것 같으세요?',
            '장기적으로 이 일을 하면서 지금의 열정을 유지하려면 어떤 노력이 필요할까요?',
        ],
    },
    "동기·정체성형": {
        1: [
            '승무원이라는 꿈을 갖게 된 계기를 말씀해 주셨는데, 실제 업무가 기대와 다를 수도 있잖아요. 그런 부분에 대해 생각해 보신 적 있으세요?',
            '{experience}이 승무원을 꿈꾸게 된 계기라고 하셨는데, 그때의 마음이 지금도 유지되고 있나요?',
        ],
        2: [
            '{core_value}을 중요하게 생각하신다고 하셨는데, 현실에서 그 가치를 지키기 어려운 상황이 올 수도 있잖아요. 그때는 어떻게 하실 것 같으세요?',
            '승무원 생활이 생각보다 힘들다는 얘기도 많은데, 그런 부분에 대해 어떻게 준비하고 계세요?',
        ],
        3: [
            '본인이 생각하는 이상적인 승무원의 모습과 실제 업무 사이에 차이가 있을 수 있는데, 그런 부분은 어떻게 받아들이실 것 같으세요?',
            '{experience}에서의 역할이 본인이 원하신 것이었나요, 아니면 상황상 맡게 되신 건가요?',
        ],
        4: [
            '지금의 동기와 열정이 5년, 10년 후에도 유지될 것 같으세요? 그렇게 생각하시는 이유가 궁금합니다.',
            '현실적인 어려움이 생겼을 때 어떻게 극복하실 계획이신가요?',
        ],
        5: [
            '지원 동기를 유지하기 위해 평소에 어떤 노력을 하고 계세요?',
            '힘든 순간이 올 때 버틸 수 있는 본인만의 방법이 있으신가요?',
        ],
    },
}

# 부드러운 Q3 꼬리질문 템플릿 (버전2, 4, 6... 짝수 버전용)
Q3_TPL_SOFT_BY_TYPE: Dict[str, Dict[int, List[str]]] = {
    "경험 요구형": {
        1: [
            "그 선택을 하기까지 다른 대안도 고려해 보셨나요? 어떤 것들이 있었는지 궁금합니다.",
            "{action}을 선택하신 이유를 조금 더 구체적으로 말씀해 주시겠어요?",
        ],
        2: [
            "그때 느끼신 감정이나 생각을 조금 더 말씀해 주시겠어요?",
            "비슷한 상황이 또 온다면 같은 선택을 하실 것 같으세요?",
        ],
        3: [
            "팀원들의 반응은 어땠나요? 긍정적인 피드백을 받으셨나요?",
            "그 과정에서 가장 어려웠던 점은 무엇이었나요?",
        ],
        4: [
            "결과적으로 어떤 점을 배우셨나요?",
            "지금 다시 그 상황이 온다면 어떤 점을 보완하고 싶으세요?",
        ],
        5: [
            "이 경험이 본인에게 어떤 변화를 가져다 주었나요?",
            "승무원 업무에 이 경험을 어떻게 연결시킬 수 있을까요?",
        ],
    },
    "가치·태도 정합성형": {
        1: [
            "고객의 입장에서 생각해 보셨을 때, 본인의 대응이 적절했다고 느끼셨나요?",
            "그 상황에서 가장 중요하게 생각하신 것은 무엇이었나요?",
        ],
        2: [
            "동료분들과의 관계는 어떠셨나요? 서로 이해가 잘 되셨나요?",
            "그 결정을 내리기까지 어떤 고민을 하셨나요?",
        ],
        3: [
            "다른 의견을 가진 분들을 어떻게 설득하셨나요?",
            "팀의 분위기가 어땠는지 조금 더 말씀해 주시겠어요?",
        ],
        4: [
            "예상치 못한 상황에서 가장 먼저 무엇을 확인하셨나요?",
            "그 경험을 통해 어떤 점을 느끼셨나요?",
        ],
        5: [
            "앞으로 비슷한 상황이 온다면 어떻게 대처하실 것 같으세요?",
            "이 경험이 승무원 업무에 어떻게 도움이 될 것 같으세요?",
        ],
    },
    "동기·정체성형": {
        1: [
            "그때의 경험이 지금도 마음에 남아 있으시군요. 구체적으로 어떤 장면이 가장 기억에 남으세요?",
            "기대와 현실이 다를 수 있다는 것에 대해 어떻게 생각하세요?",
        ],
        2: [
            "그런 상황이 온다면 어떤 마음으로 버티실 것 같으세요?",
            "주변에서 승무원 생활에 대해 어떤 조언을 해주셨나요?",
        ],
        3: [
            "본인의 성격이나 강점이 승무원 업무에 어떻게 도움이 될 것 같으세요?",
            "새로운 환경에 적응하는 본인만의 방법이 있으신가요?",
        ],
        4: [
            "장기적으로 어떤 승무원이 되고 싶으세요?",
            "본인의 꿈을 이루기 위해 어떤 준비를 하고 계세요?",
        ],
        5: [
            "평소에 스트레스를 어떻게 관리하시는 편이세요?",
            "승무원 생활을 하면서 가장 기대되는 부분은 무엇인가요?",
        ],
    },
}

# =========================
# 기타 선택 후보
# =========================

OTHER_CHOICE_CANDIDATES = [
    "기존 방식 유지",
    "혼자 해결 시도",
    "즉시 상급자/담당자에게 맡김",
    "팀에 먼저 공유 후 결정",
    "우선순위를 바꾸어 처리",
]
